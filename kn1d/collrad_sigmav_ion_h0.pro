function collrad_sigmav_ion_h0, n_e, t_e 

;Evaluates ionization rate from the collisional-radiative calculations
;of the COLLRAD code (D. Stotler, DEGAS 2 user manual, p.24)
;
; Original coding by J.Hughes
;
;Input:
;  N_E - fltarr,  electron density  (m^-3)
;  T_E- fltarr, electron temperature (eV)
;Returns;  
; Ionization Rate (m^3 s^-1)

if n_elements(n_e) NE n_elements(t_e) then message,'Number of elements in inputs do not match.'
temp=double(t_e)
dens=double(n_e)
dens=dens/1D6   ;convert from m^-3 to cm^-3
;compute indices for interpolation on sigmav grid:
indte=10D*(alog10(temp)+1.2D) > 0D < 59D
indne= 2D*(alog10(dens)-10D)  > 0D < 14D
sigmav=dblarr(15,60)
; jn =   1
sigmav(0,*)= $
 [1.00000D-99,  1.93923D-83,  6.89061D-68,  4.81352D-56,  2.12250D-46,  9.93199D-39, $
  1.25671D-32,  9.04277D-28,  6.67852D-24,  8.09280D-21,  2.33560D-18,  2.15831D-16, $
  8.07713D-15,  1.47468D-13,  1.52339D-12,  9.98880D-12,  4.56713D-11,  1.56457D-10, $
  4.25656D-10,  9.62858D-10,  1.87782D-09,  3.24950D-09,  5.10420D-09,  7.40869D-09, $
  1.00762D-08,  1.29813D-08,  1.59765D-08,  1.89101D-08,  2.16417D-08,  2.40538D-08, $
  2.60594D-08,  2.76056D-08,  2.86722D-08,  2.92677D-08,  2.94235D-08,  2.91866D-08, $
  2.86140D-08,  2.77660D-08,  2.67027D-08,  2.54802D-08,  2.41490D-08,  2.27526D-08, $
  2.13275D-08,  1.99032D-08,  1.85028D-08,  1.71439D-08,  1.58392D-08,  1.45975D-08, $
  1.34241D-08,  1.23219D-08,  1.12919D-08,  1.03333D-08,  9.44439D-09,  8.62253D-09, $
  7.86463D-09,  7.16725D-09,  6.52676D-09,  5.93948D-09,  5.40175D-09,  4.90998D-09]
; jn =   2
sigmav(1,*)= $
 [1.00000D-99,  3.08801D-83,  1.44609D-68,  6.61093D-56,  2.75895D-46,  1.23330D-38, $
  1.50372D-32,  1.05015D-27,  7.57152D-24,  8.99868D-21,  2.55656D-18,  2.33242D-16, $
  8.63712D-15,  1.56316D-13,  1.60290D-12,  1.04452D-11,  4.75051D-11,  1.62007D-10, $
  4.39062D-10,  9.89927D-10,  1.92522D-09,  3.32363D-09,  5.21011D-09,  7.54947D-09, $
  1.02527D-08,  1.31921D-08,  1.62184D-08,  1.91784D-08,  2.19306D-08,  2.43570D-08, $
  2.63707D-08,  2.79190D-08,  2.89825D-08,  2.95705D-08,  2.97153D-08,  2.94650D-08, $
  2.88770D-08,  2.80127D-08,  2.69326D-08,  2.56933D-08,  2.43455D-08,  2.29331D-08, $
  2.14927D-08,  2.00539D-08,  1.86399D-08,  1.72683D-08,  1.59518D-08,  1.46992D-08, $
  1.35157D-08,  1.24044D-08,  1.13659D-08,  1.03997D-08,  9.50370D-09,  8.67547D-09, $
  7.91178D-09,  7.20916D-09,  6.56393D-09,  5.97238D-09,  5.43080D-09,  4.93558D-09]
; jn =   3
sigmav(2,*)= $
 [5.02155D-94,  5.61298D-83,  2.01483D-68,  1.01676D-55,  3.96596D-46,  1.67642D-38, $
  1.95224D-32,  1.31341D-27,  9.18722D-24,  1.06529D-20,  2.96557D-18,  2.65962D-16, $
  9.70465D-15,  1.73375D-13,  1.75725D-12,  1.13324D-11,  5.10556D-11,  1.72647D-10, $
  4.64378D-10,  1.04004D-09,  2.01092D-09,  3.45409D-09,  5.39125D-09,  7.78327D-09, $
  1.05374D-08,  1.35232D-08,  1.65890D-08,  1.95805D-08,  2.23556D-08,  2.47963D-08, $
  2.68160D-08,  2.83628D-08,  2.94184D-08,  2.99932D-08,  3.01207D-08,  2.98500D-08, $
  2.92397D-08,  2.83519D-08,  2.72479D-08,  2.59849D-08,  2.46139D-08,  2.31792D-08, $
  2.17176D-08,  2.02588D-08,  1.88261D-08,  1.74372D-08,  1.61046D-08,  1.48372D-08, $
  1.36402D-08,  1.25165D-08,  1.14668D-08,  1.04902D-08,  9.58494D-09,  8.74826D-09, $
  7.97693D-09,  7.26741D-09,  6.61595D-09,  6.01878D-09,  5.47214D-09,  4.97237D-09]
; jn =   4
sigmav(3,*)= $
 [5.02155D-94,  1.21407D-82,  2.72028D-67,  1.85445D-55,  6.72737D-46,  2.66857D-38, $
  2.94291D-32,  1.89009D-27,  1.27059D-23,  1.42341D-20,  3.84394D-18,  3.35462D-16, $
  1.19403D-14,  2.08505D-13,  2.06925D-12,  1.30910D-11,  5.79549D-11,  1.92922D-10, $
  5.11701D-10,  1.13197D-09,  2.16518D-09,  3.68451D-09,  5.70499D-09,  8.18013D-09, $
  1.10109D-08,  1.40621D-08,  1.71800D-08,  2.02091D-08,  2.30078D-08,  2.54591D-08, $
  2.74780D-08,  2.90144D-08,  3.00515D-08,  3.06018D-08,  3.07000D-08,  3.03970D-08, $
  2.97526D-08,  2.88297D-08,  2.76907D-08,  2.63932D-08,  2.49889D-08,  2.35223D-08, $
  2.20305D-08,  2.05434D-08,  1.90843D-08,  1.76708D-08,  1.63157D-08,  1.50275D-08, $
  1.38115D-08,  1.26705D-08,  1.16050D-08,  1.06142D-08,  9.69599D-09,  8.84763D-09, $
  8.06578D-09,  7.34678D-09,  6.68680D-09,  6.08199D-09,  5.52848D-09,  5.02256D-09]
; jn =   5
sigmav(4,*)= $
 [1.00000D-99,  3.19565D-82,  4.18721D-67,  4.17673D-55,  1.40099D-45,  5.15844D-38, $
  5.30819D-32,  3.19983D-27,  2.03100D-23,  2.16062D-20,  5.57007D-18,  4.66256D-16, $
  1.59854D-14,  2.69884D-13,  2.59804D-12,  1.59955D-11,  6.91065D-11,  2.25123D-10, $
  5.85824D-10,  1.27442D-09,  2.40234D-09,  4.03669D-09,  6.18242D-09,  8.78196D-09, $
  1.17266D-08,  1.48744D-08,  1.80675D-08,  2.11495D-08,  2.39793D-08,  2.64419D-08, $
  2.84550D-08,  2.99714D-08,  3.09774D-08,  3.14880D-08,  3.15405D-08,  3.11880D-08, $
  3.04918D-08,  2.95165D-08,  2.83255D-08,  2.69772D-08,  2.55242D-08,  2.40112D-08, $
  2.24756D-08,  2.09474D-08,  1.94502D-08,  1.80015D-08,  1.66139D-08,  1.52960D-08, $
  1.40528D-08,  1.28870D-08,  1.17991D-08,  1.07879D-08,  9.85127D-09,  8.98633D-09, $
  8.18954D-09,  7.45712D-09,  6.78510D-09,  6.16949D-09,  5.60633D-09,  5.09177D-09]
; jn =   6
sigmav(5,*)= $
 [1.00000D-99,  9.52529D-82,  1.19701D-66,  1.07741D-54,  3.31427D-45,  1.11936D-37, $
  1.06082D-31,  5.92680D-27,  3.51233D-23,  3.51436D-20,  8.57944D-18,  6.84166D-16, $
  2.24629D-14,  3.64844D-13,  3.39221D-12,  2.02490D-11,  8.51006D-11,  2.70549D-10, $
  6.89107D-10,  1.47130D-09,  2.72871D-09,  4.52099D-09,  6.84050D-09,  9.61544D-09, $
  1.27242D-08,  1.60150D-08,  1.93237D-08,  2.24907D-08,  2.53748D-08,  2.78627D-08, $
  2.98752D-08,  3.13689D-08,  3.23341D-08,  3.27899D-08,  3.27776D-08,  3.23533D-08, $
  3.15814D-08,  3.05288D-08,  2.92605D-08,  2.78369D-08,  2.63110D-08,  2.47287D-08, $
  2.31278D-08,  2.15385D-08,  1.99845D-08,  1.84834D-08,  1.70476D-08,  1.56856D-08, $
  1.44023D-08,  1.32000D-08,  1.20790D-08,  1.10379D-08,  1.00744D-08,  9.18520D-09, $
  8.36663D-09,  7.61467D-09,  6.92516D-09,  6.29390D-09,  5.71676D-09,  5.18974D-09]
; jn =   7
sigmav(6,*)= $
 [5.02155D-94,  1.27796D-79,  3.53013D-66,  3.02561D-54,  8.53989D-45,  2.63882D-37, $
  2.29129D-31,  1.17818D-26,  6.46754D-23,  6.03915D-20,  1.38638D-17,  1.04711D-15, $
  3.27702D-14,  5.10164D-13,  4.56794D-12,  2.63735D-11,  1.07611D-10,  3.33347D-10, $
  8.30037D-10,  1.73776D-09,  3.16898D-09,  5.17512D-09,  7.73404D-09,  1.07569D-08, $
  1.41054D-08,  1.76140D-08,  2.11077D-08,  2.44203D-08,  2.74072D-08,  2.99553D-08, $
  3.19878D-08,  3.34655D-08,  3.43843D-08,  3.47692D-08,  3.46670D-08,  3.41395D-08, $
  3.32557D-08,  3.20868D-08,  3.07012D-08,  2.91615D-08,  2.75231D-08,  2.58330D-08, $
  2.41302D-08,  2.24454D-08,  2.08027D-08,  1.92196D-08,  1.77085D-08,  1.62777D-08, $
  1.49318D-08,  1.36728D-08,  1.25005D-08,  1.14132D-08,  1.04081D-08,  9.48171D-09, $
  8.62980D-09,  7.84806D-09,  7.13197D-09,  6.47704D-09,  5.87884D-09,  5.33309D-09]
; jn =   8
sigmav(7,*)= $
 [1.00000D-99,  9.49905D-81,  1.21157D-65,  9.63177D-54,  2.50897D-44,  7.07421D-37, $
  5.58076D-31,  2.61346D-26,  1.31537D-22,  1.13546D-19,  2.42899D-17,  1.72162D-15, $
  5.08790D-14,  7.52327D-13,  6.43388D-12,  3.56797D-11,  1.40576D-10,  4.22650D-10, $
  1.02627D-09,  2.10411D-09,  3.77155D-09,  6.07296D-09,  8.97160D-09,  1.23596D-08, $
  1.60778D-08,  1.99399D-08,  2.37526D-08,  2.73347D-08,  3.05313D-08,  3.32238D-08, $
  3.53349D-08,  3.68290D-08,  3.77083D-08,  3.80062D-08,  3.77787D-08,  3.70969D-08, $
  3.60386D-08,  3.46826D-08,  3.31039D-08,  3.13707D-08,  2.95424D-08,  2.76695D-08, $
  2.57929D-08,  2.39450D-08,  2.21505D-08,  2.04275D-08,  1.87883D-08,  1.72408D-08, $
  1.57892D-08,  1.44348D-08,  1.31767D-08,  1.20125D-08,  1.09387D-08,  9.95088D-09, $
  9.04435D-09,  8.21404D-09,  7.45483D-09,  6.76166D-09,  6.12960D-09,  5.55389D-09]
; jn =   9
sigmav(8,*)= $
 [5.02157D-94,  1.52401D-79,  4.64668D-65,  3.52562D-53,  8.60248D-44,  2.23707D-36, $
  1.61239D-30,  6.86706D-26,  3.13746D-22,  2.45906D-19,  4.78939D-17,  3.10847D-15, $
  8.48355D-14,  1.17030D-12,  9.43638D-12,  4.98402D-11,  1.88682D-10,  5.49278D-10, $
  1.29978D-09,  2.61118D-09,  4.60686D-09,  7.32802D-09,  1.07249D-08,  1.46683D-08, $
  1.89719D-08,  2.34184D-08,  2.77831D-08,  3.18564D-08,  3.54606D-08,  3.84622D-08, $
  4.07768D-08,  4.23693D-08,  4.32485D-08,  4.34589D-08,  4.30706D-08,  4.21692D-08, $
  4.08473D-08,  3.91975D-08,  3.73067D-08,  3.52535D-08,  3.31056D-08,  3.09200D-08, $
  2.87424D-08,  2.66088D-08,  2.45462D-08,  2.25740D-08,  2.07050D-08,  1.89472D-08, $
  1.73042D-08,  1.57766D-08,  1.43625D-08,  1.30585D-08,  1.18598D-08,  1.07608D-08, $
  9.75556D-09,  8.83789D-09,  8.00154D-09,  7.24040D-09,  6.54854D-09,  5.92032D-09]
; jn =   10
sigmav(9,*)= $
 [6.57984D-99,  3.12266D-79,  1.90237D-64,  1.39798D-52,  3.26114D-43,  7.99326D-36, $
  5.34708D-30,  2.08169D-25,  8.59191D-22,  6.04879D-19,  1.05911D-16,  6.21818D-15, $
  1.55015D-13,  1.97574D-12,  1.48881D-11,  7.42751D-11,  2.68099D-10,  7.50404D-10, $
  1.72007D-09,  3.36947D-09,  5.83003D-09,  9.13864D-09,  1.32310D-08,  1.79548D-08, $
  2.30925D-08,  2.83899D-08,  3.35826D-08,  3.84224D-08,  4.26980D-08,  4.62497D-08, $
  4.89764D-08,  5.08358D-08,  5.18383D-08,  5.20368D-08,  5.15155D-08,  5.03774D-08, $
  4.87340D-08,  4.66970D-08,  4.43717D-08,  4.18534D-08,  3.92245D-08,  3.65541D-08, $
  3.38983D-08,  3.13009D-08,  2.87948D-08,  2.64035D-08,  2.41427D-08,  2.20217D-08, $
  2.00446D-08,  1.82117D-08,  1.65205D-08,  1.49659D-08,  1.35419D-08,  1.22411D-08, $
  1.10557D-08,  9.97781D-09,  8.99934D-09,  8.11247D-09,  7.30968D-09,  6.58379D-09]
; jn =   11
sigmav(10,*)= $
 [5.02165D-94,  7.23483D-79,  7.18473D-64,  5.20288D-52,  1.18541D-42,  2.80684D-35, $
  1.78891D-29,  6.54358D-25,  2.50868D-21,  1.62582D-18,  2.59802D-16,  1.38202D-14, $
  3.11275D-13,  3.59539D-12,  2.47501D-11,  1.14059D-10,  3.85018D-10,  1.02035D-09, $
  2.23998D-09,  4.24477D-09,  7.16452D-09,  1.10289D-08,  1.57632D-08,  2.12011D-08, $
  2.71066D-08,  3.32026D-08,  3.91980D-08,  4.48166D-08,  4.98202D-08,  5.40250D-08, $
  5.73106D-08,  5.96211D-08,  6.09590D-08,  6.13749D-08,  6.09551D-08,  5.98088D-08, $
  5.80569D-08,  5.58220D-08,  5.32219D-08,  5.03646D-08,  4.73454D-08,  4.42457D-08, $
  4.11331D-08,  3.80619D-08,  3.50745D-08,  3.22025D-08,  2.94686D-08,  2.68879D-08, $
  2.44691D-08,  2.22162D-08,  2.01291D-08,  1.82046D-08,  1.64373D-08,  1.48205D-08, $
  1.33459D-08,  1.20049D-08,  1.07884D-08,  9.68734D-09,  8.69263D-09,  7.79552D-09]
; jn =   12
sigmav(11,*)= $
 [5.02166D-94,  2.11229D-78,  2.24556D-63,  1.64685D-51,  3.76181D-42,  8.83729D-35, $
  5.53407D-29,  1.96853D-24,  7.23477D-21,  4.38191D-18,  6.32570D-16,  2.95914D-14, $
  5.81675D-13,  5.92425D-12,  3.66632D-11,  1.55190D-10,  4.90717D-10,  1.23849D-09, $
  2.62341D-09,  4.84507D-09,  8.02964D-09,  1.22034D-08,  1.72886D-08,  2.31155D-08, $
  2.94424D-08,  3.59846D-08,  4.24410D-08,  4.85240D-08,  5.39834D-08,  5.86240D-08, $
  6.23155D-08,  6.49935D-08,  6.66539D-08,  6.73428D-08,  6.71440D-08,  6.61657D-08, $
  6.45290D-08,  6.23581D-08,  5.97730D-08,  5.68847D-08,  5.37918D-08,  5.05796D-08, $
  4.73193D-08,  4.40694D-08,  4.08762D-08,  3.77754D-08,  3.47938D-08,  3.19501D-08, $
  2.92571D-08,  2.67223D-08,  2.43489D-08,  2.21372D-08,  2.00847D-08,  1.81872D-08, $
  1.64392D-08,  1.48339D-08,  1.33641D-08,  1.20222D-08,  1.08000D-08,  9.68976D-09]
; jn =   13
sigmav(12,*)= $
 [1.02081D-98,  4.47311D-78,  5.34817D-63,  4.14904D-51,  9.77616D-42,  2.35249D-34, $
  1.48572D-28,  5.25591D-24,  1.86340D-20,  1.02703D-17,  1.27333D-15,  5.03562D-14, $
  8.56836D-13,  7.82720D-12,  4.48312D-11,  1.79786D-10,  5.47667D-10,  1.34709D-09, $
  2.80338D-09,  5.11463D-09,  8.40560D-09,  1.27017D-08,  1.79249D-08,  2.39045D-08, $
  3.03980D-08,  3.71182D-08,  4.37610D-08,  5.00353D-08,  5.56869D-08,  6.05171D-08, $
  6.43918D-08,  6.72436D-08,  6.90662D-08,  6.99038D-08,  6.98389D-08,  6.89790D-08, $
  6.74448D-08,  6.53604D-08,  6.28462D-08,  6.00133D-08,  5.69610D-08,  5.37750D-08, $
  5.05272D-08,  4.72765D-08,  4.40699D-08,  4.09436D-08,  3.79250D-08,  3.50335D-08, $
  3.22823D-08,  2.96795D-08,  2.72292D-08,  2.49320D-08,  2.27865D-08,  2.07890D-08, $
  1.89348D-08,  1.72182D-08,  1.56327D-08,  1.41717D-08,  1.28281D-08,  1.15951D-08]
; jn =   14
sigmav(13,*)= $
 [7.36093D-99,  6.06931D-78,  8.53837D-63,  7.35153D-51,  1.85978D-41,  4.68546D-34, $
  3.08545D-28,  1.10201D-23,  3.74288D-20,  1.81668D-17,  1.90634D-15,  6.56158D-14, $
  1.01772D-12,  8.77381D-12,  4.84655D-11,  1.89940D-10,  5.69929D-10,  1.38795D-09, $
  2.86925D-09,  5.21207D-09,  8.54009D-09,  1.28799D-08,  1.81517D-08,  2.41857D-08, $
  3.07368D-08,  3.75185D-08,  4.42257D-08,  5.05663D-08,  5.62850D-08,  6.11817D-08, $
  6.51216D-08,  6.80363D-08,  6.99187D-08,  7.08127D-08,  7.08002D-08,  6.99885D-08, $
  6.84982D-08,  6.64537D-08,  6.39751D-08,  6.11739D-08,  5.81493D-08,  5.49873D-08, $
  5.17599D-08,  4.85263D-08,  4.53334D-08,  4.22178D-08,  3.92068D-08,  3.63199D-08, $
  3.35705D-08,  3.09666D-08,  2.85124D-08,  2.62086D-08,  2.40536D-08,  2.20439D-08, $
  2.01749D-08,  1.84406D-08,  1.68348D-08,  1.53508D-08,  1.39816D-08,  1.27203D-08]
; jn =   15
sigmav(14,*)= $
 [6.38105D-99,  6.80257D-78,  8.60837D-63,  7.83728D-51,  2.31015D-41,  6.54058D-34, $
  4.51976D-28,  1.65716D-23,  5.46805D-20,  2.40282D-17,  2.26542D-15,  7.26816D-14, $
  1.08308D-12,  9.13105D-12,  4.97793D-11,  1.93504D-10,  5.77529D-10,  1.40178D-09, $
  2.89141D-09,  5.24401D-09,  8.58370D-09,  1.29380D-08,  1.82248D-08,  2.42751D-08, $
  3.08494D-08,  3.76528D-08,  4.43870D-08,  5.07519D-08,  5.64953D-08,  6.14129D-08, $
  6.53730D-08,  6.83073D-08,  7.02083D-08,  7.11199D-08,  7.11239D-08,  7.03277D-08, $
  6.88519D-08,  6.68206D-08,  6.43543D-08,  6.15643D-08,  5.85500D-08,  5.53973D-08, $
  5.21785D-08,  4.89525D-08,  4.57666D-08,  4.26572D-08,  3.96516D-08,  3.67696D-08, $
  3.40243D-08,  3.14241D-08,  2.89729D-08,  2.66715D-08,  2.45184D-08,  2.25100D-08, $
  2.06417D-08,  1.89076D-08,  1.73014D-08,  1.58163D-08,  1.44454D-08,  1.31819D-08]

logsigmav=alog(sigmav)
sigmav_out=exp(interpolate(logsigmav,indne,indte))
;convert from cm^3/s to m^3/s
sigmav_out=sigmav_out/1D6 
return, sigmav_out

end
